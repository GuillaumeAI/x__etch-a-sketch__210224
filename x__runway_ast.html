<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">

<!--@STCGoal WIP Post and received a stylized img using the picasso image -->

<html>
<head>
	<meta charset="UTF-8">
	<title>Etch-A-Sketch</title>
	<link href="x__savediv.css" rel="stylesheet" type="text/css">

 
   
</head>
<body>

  
   <div id="mydiv" style="background-image:url(Koala.jpg) ;background-size: 100%;
   background-size :200px 200px;
   background-repeat: no-repeat;">
   <p>text!</p>
   <p>I am going to tell you a bit more about it</p>
   <img src="dummy.png">
   </div>
<img src="mug.png" height="100" width="100"/>
</div>

<br>
<hr>

  
 <script type="text/javascript" src="/html2canvas/dist/html2canvas.js"></script>

 <!-- include this in your HTML file -->
<script src="https://cdn.jsdelivr.net/npm/@runwayml/hosted-models@latest/dist/hosted-models.js"></script>



<script type="text/javascript">
    html2canvas(document.getElementById("mydiv")).then(function(canvas) {
        document.body.appendChild(canvas);
       // document.appendChild("<hr>");
        var enc64 = imgToBase64(canvas);
       // console.log(enc64);
        
    const model = new rw.HostedModel({
        url: "https://pika.hosted-models.runwayml.cloud/v1/",
        token: "TOKENHERE",
        });
        //// You can use the info() method to see what type of input object the model expects
        model.info().then(info => console.log(info));
        const inputs = {
        "contentImage": enc64
        };
        model.query(inputs).then(outputs => {
        const { stylizedImage } = outputs;
        console.log('-------Runway stylized:');
console.log(stylizedImage);
var image = new Image();
image.src= stylizedImage;
        document.body.appendChild(image);
        // use the outputs in your project
        });

    });

   function imgToBase64(img) {
       const canvas = document.createElement('canvas');
       const ctx = canvas.getContext('2d');
       canvas.width = img.width;
       canvas.height = img.height;

       // I think this won't work inside the function from the console
       img.crossOrigin = 'anonymous';

       ctx.drawImage(img, 0, 0);

       return canvas.toDataURL();
}

</script>
 

</body>

</html>